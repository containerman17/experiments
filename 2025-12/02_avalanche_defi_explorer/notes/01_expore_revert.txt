# Pool Quote Revert Investigation - ALL RESOLVED ✅

## Issue #1: Pangolin V3 Pool Callback - FIXED ✅

### Root Cause
Pangolin V3 pools use a custom callback function `pangolinv3SwapCallback(int256,int256,bytes)` instead of the standard `uniswapV3SwapCallback`.

### Debug Process
1. Used `debug_traceCall` RPC endpoint on reverting pool `0x11476e10eb79ddffa6f2585be526d2bd840c3e20`
2. Identified callback selector `0x4179b664` being called
3. Fetched pool source code from Routescan API
4. Found the callback in `IPangolinV3SwapCallback.sol`

### Fix Applied
- Added `pangolinv3SwapCallback` function to `Hayabusa.sol` (lines 495-505)
- Function selector: `0x4179b664`
- **Result**: Pool now quotes successfully

## Issue #2: Pharaoh V3 / Ramses V2 Pool Callback - FIXED ✅

### Root Cause
Pharaoh V3 pools (which are Ramses V2 forks) use callback `ramsesV2SwapCallback(int256,int256,bytes)` instead of standard V3 callback.

### Debug Process
1. Used `debug_traceCall` on reverting pool `0xa20c959b19f114e9c2d81547734cdc1110bd773d`
2. Identified callback selector `0x654b6487` being called
3. Matched to `ramsesV2SwapCallback` signature

### Fix Applied
- Added `ramsesV2SwapCallback` function to `Hayabusa.sol` (lines 506-516)
- Function selector: `0x654b6487`
- **Result**: Pool now quotes successfully

---

## Final Status

✅ **All 27/27 USDC-WAVAX pools working!**

### Current Deployment
- Contract Address: `0xcae1b71c47b7ce8c078f425024b48ff54d1220a0`
- Callbacks implemented:
  - `uniswapV3SwapCallback` (standard UniV3)
  - `algebraSwapCallback` (Algebra / Thena)
  - `pangolinv3SwapCallback` (Pangolin V3)
  - `ramsesV2SwapCallback` (Pharaoh V3 / Ramses V2)
  - `balancerUnlockCallback` (Balancer V3)

### Best Quote
- Pool: `0xfae3f424a0a47706811521e3ee268f00cfb5c45e`
- Output: 0.080683 WAVAX
- Price: ~$12.39/WAVAX